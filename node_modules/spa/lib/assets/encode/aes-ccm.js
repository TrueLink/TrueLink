(function(){"use strict";var t={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};"undefined"!=typeof module&&module.exports&&(module.exports=t),t.bitArray={bitSlice:function(e,i,n){return e=t.bitArray._shiftRight(e.slice(i/32),32-(31&i)).slice(1),void 0===n?e:t.bitArray.clamp(e,n-i)},extract:function(t,e,i){var n,r=Math.floor(-e-i&31);return n=-32&(e+i-1^e)?t[e/32|0]<<32-r^t[e/32+1|0]>>>r:t[e/32|0]>>>r,n&(1<<i)-1},concat:function(e,i){if(0===e.length||0===i.length){return e.concat(i)}var o=e[e.length-1],s=t.bitArray.getPartial(o);return 32===s?e.concat(i):t.bitArray._shiftRight(i,s,0|o,e.slice(0,e.length-1))},bitLength:function(e){var n,i=e.length;return 0===i?0:(n=e[i-1],32*(i-1)+t.bitArray.getPartial(n))},clamp:function(e,i){if(32*e.length<i){return e}e=e.slice(0,Math.ceil(i/32));var n=e.length;return i=31&i,n>0&&i&&(e[n-1]=t.bitArray.partial(i,e[n-1]&2147483648>>i-1,1)),e},partial:function(t,e,i){return 32===t?e:(i?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(e,i){if(t.bitArray.bitLength(e)!==t.bitArray.bitLength(i)){return!1}var r,n=0;for(r=0;r<e.length;r++){n|=e[r]^i[r]}return 0===n},_shiftRight:function(e,i,n,r){var o,a,s=0;for(void 0===r&&(r=[]);i>=32;i-=32){r.push(n),n=0}if(0===i){return r.concat(e)}for(o=0;o<e.length;o++){r.push(n|e[o]>>>i),n=e[o]<<32-i}return s=e.length?e[e.length-1]:0,a=t.bitArray.getPartial(s),r.push(t.bitArray.partial(i+a&31,i+a>32?n:r.pop(),1)),r},_xor4:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]}},t.codec.bytes={fromBits:function(e){var r,o,i=[],n=t.bitArray.bitLength(e);for(r=0;n/8>r;r++){0===(3&r)&&(o=e[r/4]),i.push(o>>>24),o<<=8}return i},toBits:function(e){var n,i=[],r=0;for(n=0;n<e.length;n++){r=r<<8|e[n],3===(3&n)&&(i.push(r),r=0)}return 3&n&&i.push(t.bitArray.partial(8*(3&n),r)),i}},t.codec.utf8String={fromBits:function(e){var r,o,i="",n=t.bitArray.bitLength(e);for(r=0;n/8>r;r++){0===(3&r)&&(o=e[r/4]),i+=String.fromCharCode(o>>>24),o<<=8}return decodeURIComponent(escape(i))},toBits:function(e){e=unescape(encodeURIComponent(e));var n,i=[],r=0;for(n=0;n<e.length;n++){r=r<<8|e.charCodeAt(n),3===(3&n)&&(i.push(r),r=0)}return 3&n&&i.push(t.bitArray.partial(8*(3&n),r)),i}},t.codec.hex={fromBits:function(e){var n,i="";for(n=0;n<e.length;n++){i+=((0|e[n])+0xf00000000000).toString(16).substr(4)}return i.substr(0,t.bitArray.bitLength(e)/4)},toBits:function(e){var i,r,n=[];for(e=e.replace(/\s|0x/g,""),r=e.length,e+="00000000",i=0;i<e.length;i+=8){n.push(0^parseInt(e.substr(i,8),16))}return t.bitArray.clamp(n,4*r)}},t.cipher.aes=function(e){this._tables[0][0][0]||this._precompute();var i,n,r,o,s,a=this._tables[0][4],h=this._tables[1],c=e.length,f=1;if(4!==c&&6!==c&&8!==c){throw new t.exception.invalid("invalid aes key size")}for(this._key=[o=e.slice(0),s=[]],i=c;4*c+28>i;i++){r=o[i-1],(i%c===0||8===c&&i%c===4)&&(r=a[r>>>24]<<24^a[r>>16&255]<<16^a[r>>8&255]<<8^a[255&r],i%c===0&&(r=r<<8^r>>>24^f<<24,f=f<<1^283*(f>>7))),o[i]=o[i-c]^r}for(n=0;i;n++,i--){r=o[3&n?i:i-4],s[n]=4>=i||4>n?r:h[0][a[r>>>24]]^h[1][a[r>>16&255]]^h[2][a[r>>8&255]]^h[3][a[255&r]]}},t.cipher.aes.prototype={encrypt:function(t){return this._crypt(t,0)},decrypt:function(t){return this._crypt(t,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var r,o,s,c,f,u,l,p,d,t=this._tables[0],e=this._tables[1],i=t[4],n=e[4],a=[],h=[];for(r=0;256>r;r++){h[(a[r]=r<<1^283*(r>>7))^r]=r}for(o=s=0;!i[o];o^=c||1,s=h[s]||1){for(l=s^s<<1^s<<2^s<<3^s<<4,l=l>>8^255&l^99,i[o]=l,n[l]=o,u=a[f=a[c=a[o]]],d=16843009*u^65537*f^257*c^16843008*o,p=257*a[l]^16843008*l,r=0;4>r;r++){t[r][o]=p=p<<24^p>>>8,e[r][l]=d=d<<24^d>>>8}}for(r=0;5>r;r++){t[r]=t[r].slice(0),e[r]=e[r].slice(0)}},_crypt:function(e,i){if(4!==e.length){throw new t.exception.invalid("invalid aes block size")}var h,c,f,l,n=this._key[i],r=e[0]^n[0],o=e[i?3:1]^n[1],s=e[2]^n[2],a=e[i?1:3]^n[3],u=n.length/4-2,p=4,d=[0,0,0,0],g=this._tables[i],_=g[0],y=g[1],v=g[2],m=g[3],w=g[4];for(l=0;u>l;l++){h=_[r>>>24]^y[o>>16&255]^v[s>>8&255]^m[255&a]^n[p],c=_[o>>>24]^y[s>>16&255]^v[a>>8&255]^m[255&r]^n[p+1],f=_[s>>>24]^y[a>>16&255]^v[r>>8&255]^m[255&o]^n[p+2],a=_[a>>>24]^y[r>>16&255]^v[o>>8&255]^m[255&s]^n[p+3],p+=4,r=h,o=c,s=f}for(l=0;4>l;l++){d[i?3&-l:l]=w[r>>>24]<<24^w[o>>16&255]<<16^w[s>>8&255]<<8^w[255&a]^n[p++],h=r,r=o,o=s,s=a,a=h}return d}},t.hash.sha256=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},t.hash.sha256.hash=function(e){return(new t.hash.sha256).update(e).finalize()},t.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(e){"string"==typeof e&&(e=t.codec.utf8String.toBits(e));var i,n=this._buffer=t.bitArray.concat(this._buffer,e),r=this._length,o=this._length=r+t.bitArray.bitLength(e);for(i=512+r&-512;o>=i;i+=512){this._block(n.splice(0,16))}return this},finalize:function(){var e,i=this._buffer,n=this._h;for(i=t.bitArray.concat(i,[t.bitArray.partial(1,1)]),e=i.length+2;15&e;e++){i.push(0)}for(i.push(Math.floor(this._length/4294967296)),i.push(0|this._length);i.length;){this._block(i.splice(0,16))}return this.reset(),n},_init:[],_key:[],_precompute:function(){function n(t){return 4294967296*(t-Math.floor(t))|0}var i,t=0,e=2;t:for(;64>t;e++){for(i=2;e>=i*i;i++){if(e%i===0){continue t}}8>t&&(this._init[t]=n(Math.pow(e,.5))),this._key[t]=n(Math.pow(e,1/3)),t++}},_block:function(t){var e,i,n,r,o=t.slice(0),s=this._h,a=this._key,h=s[0],c=s[1],f=s[2],u=s[3],l=s[4],p=s[5],d=s[6],g=s[7];for(e=0;64>e;e++){16>e?i=o[e]:(n=o[e+1&15],r=o[e+14&15],i=o[15&e]=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+o[15&e]+o[e+9&15]|0),i=i+g+(l>>>6^l>>>11^l>>>25^l<<26^l<<21^l<<7)+(d^l&(p^d))+a[e],g=d,d=p,p=l,l=u+i|0,u=f,f=c,c=h,h=i+(c&f^u&(c^f))+(c>>>2^c>>>13^c>>>22^c<<30^c<<19^c<<10)|0}s[0]=s[0]+h|0,s[1]=s[1]+c|0,s[2]=s[2]+f|0,s[3]=s[3]+u|0,s[4]=s[4]+l|0,s[5]=s[5]+p|0,s[6]=s[6]+d|0,s[7]=s[7]+g|0}},t.misc.hmac=function(e,i){this._hash=i=i||t.hash.sha256;var r,n=[[],[]],o=i.prototype.blockSize/32;for(this._baseHash=[new i,new i],e.length>o&&(e=i.hash(e)),r=0;o>r;r++){n[0][r]=909522486^e[r],n[1][r]=1549556828^e[r]}this._baseHash[0].update(n[0]),this._baseHash[1].update(n[1]),this._resultHash=new i(this._baseHash[0])},t.misc.hmac.prototype.encrypt=t.misc.hmac.prototype.mac=function(e){if(this._updated){throw new t.exception.invalid("encrypt on already updated hmac called!")}return this.update(e),this.digest(e)},t.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]),this._updated=!1},t.misc.hmac.prototype.update=function(t){this._updated=!0,this._resultHash.update(t)},t.misc.hmac.prototype.digest=function(){var t=this._resultHash.finalize(),e=new this._hash(this._baseHash[1]).update(t).finalize();return this.reset(),e},t.misc.pbkdf2=function(e,i,n,r,o){if(n=n||1e3,0>r||0>n){throw t.exception.invalid("invalid params to pbkdf2")}"string"==typeof e&&(e=t.codec.utf8String.toBits(e)),"string"==typeof i&&(i=t.codec.utf8String.toBits(i)),o=o||t.misc.hmac;var a,h,c,f,u,s=new o(e),l=[],p=t.bitArray;for(u=1;32*l.length<(r||1);u++){for(a=h=s.encrypt(p.concat(i,[u])),c=1;n>c;c++){for(h=s.encrypt(h),f=0;f<h.length;f++){a[f]^=h[f]}}l=l.concat(a)}return r&&(l=p.clamp(l,r)),l},t.prng=function(e){this._pools=[new t.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=void 0,this._defaultParanoia=e,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},t.prng.prototype={randomWords:function(e,i){var r,s,n=[],o=this.isReady(i);if(o===this._NOT_READY){throw new t.exception.notReady("generator isn't seeded")}for(o&this._REQUIRES_RESEED&&this._reseedFromPools(!(o&this._READY)),r=0;e>r;r+=4){(r+1)%this._MAX_WORDS_PER_BURST===0&&this._gate(),s=this._gen4words(),n.push(s[0],s[1],s[2],s[3])}return this._gate(),n.slice(0,e)},setDefaultParanoia:function(t,e){if(0===t&&"Setting paranoia=0 will ruin your security; use it only for testing"!==e){throw"Setting paranoia=0 will ruin your security; use it only for testing"}this._defaultParanoia=t},addEntropy:function(e,i,n){n=n||"user";var r,o,s,u,a=(new Date).valueOf(),h=this._robins[n],c=this.isReady(),f=0;switch(r=this._collectorIds[n],void 0===r&&(r=this._collectorIds[n]=this._collectorIdNext++),void 0===h&&(h=this._robins[n]=0),this._robins[n]=(this._robins[n]+1)%this._pools.length,typeof e){case"number":void 0===i&&(i=1),this._pools[h].update([r,this._eventId++,1,i,a,1,0|e]);break;case"object":if(u=Object.prototype.toString.call(e),"[object Uint32Array]"===u){for(s=[],o=0;o<e.length;o++){s.push(e[o])}e=s}else{for("[object Array]"!==u&&(f=1),o=0;o<e.length&&!f;o++){"number"!=typeof e[o]&&(f=1)}}if(!f){if(void 0===i){for(i=0,o=0;o<e.length;o++){for(s=e[o];s>0;){i++,s>>>=1}}}this._pools[h].update([r,this._eventId++,2,i,a,e.length].concat(e))}break;case"string":void 0===i&&(i=e.length),this._pools[h].update([r,this._eventId++,3,i,a,e.length]),this._pools[h].update(e);break;default:f=1}if(f){throw new t.exception.bug("random: addEntropy only supports number, array of numbers or string")}this._poolEntropy[h]+=i,this._poolStrength+=i,c===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(t){var e=this._PARANOIA_LEVELS[void 0!==t?t:this._defaultParanoia];return this._strength&&this._strength>=e?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=e?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(t){var e=this._PARANOIA_LEVELS[t?t:this._defaultParanoia];return this._strength>=e?1:this._poolStrength>e?1:this._poolStrength/e},startCollectors:function(){if(!this._collectorsStarted){if(this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector)},window.addEventListener){window.addEventListener("load",this._eventListener.loadTimeCollector,!1),window.addEventListener("mousemove",this._eventListener.mouseCollector,!1),window.addEventListener("keypress",this._eventListener.keyboardCollector,!1),window.addEventListener("devicemotion",this._eventListener.accelerometerCollector,!1)}else{if(!document.attachEvent){throw new t.exception.bug("can't attach event")}document.attachEvent("onload",this._eventListener.loadTimeCollector),document.attachEvent("onmousemove",this._eventListener.mouseCollector),document.attachEvent("keypress",this._eventListener.keyboardCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._eventListener.loadTimeCollector,!1),window.removeEventListener("mousemove",this._eventListener.mouseCollector,!1),window.removeEventListener("keypress",this._eventListener.keyboardCollector,!1),window.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this._eventListener.loadTimeCollector),document.detachEvent("onmousemove",this._eventListener.mouseCollector),document.detachEvent("keypress",this._eventListener.keyboardCollector)),this._collectorsStarted=!1)},addEventListener:function(t,e){this._callbacks[t][this._callbackI++]=e},removeEventListener:function(t,e){var i,n,r=this._callbacks[t],o=[];for(n in r){r.hasOwnProperty(n)&&r[n]===e&&o.push(n)}for(i=0;i<o.length;i++){n=o[i],delete r[n]}},_bind:function(t){var e=this;return function(){t.apply(e,arguments)}},_gen4words:function(){for(var t=0;4>t&&(this._counter[t]=this._counter[t]+1|0,!this._counter[t]);t++){}return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new t.cipher.aes(this._key)},_reseed:function(e){this._key=t.hash.sha256.hash(this._key.concat(e)),this._cipher=new t.cipher.aes(this._key);for(var i=0;4>i&&(this._counter[i]=this._counter[i]+1|0,!this._counter[i]);i++){}},_reseedFromPools:function(e){var r,i=[],n=0;for(this._nextReseed=i[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,r=0;16>r;r++){i.push(4294967296*Math.random()|0)}for(r=0;r<this._pools.length&&(i=i.concat(this._pools[r].finalize()),n+=this._poolEntropy[r],this._poolEntropy[r]=0,e||!(this._reseedCount&1<<r));r++){}this._reseedCount>=1<<this._pools.length&&(this._pools.push(new t.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=n,n>this._strength&&(this._strength=n),this._reseedCount++,this._reseed(i)},_keyboardCollector:function(){this._addCurrentTimeToEntropy(1)},_mouseCollector:function(e){var i=e.x||e.clientX||e.offsetX||0,n=e.y||e.clientY||e.offsetY||0;t.random.addEntropy([i,n],2,"mouse"),this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(e){window&&window.performance&&"function"==typeof window.performance.now?t.random.addEntropy(window.performance.now(),e,"loadtime"):t.random.addEntropy((new Date).valueOf(),e,"loadtime")},_accelerometerCollector:function(e){var i=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z,n="";window.orientation&&(n=window.orientation),t.random.addEntropy([i,n],3,"accelerometer"),this._addCurrentTimeToEntropy(0)},_fireEvent:function(e,i){var n,r=t.random._callbacks[e],o=[];for(n in r){r.hasOwnProperty(n)&&o.push(r[n])}for(n=0;n<o.length;n++){o[n](i)}}},t.random=new t.prng(6),function(){try{var e,i,r;if("undefined"!=typeof module&&module.exports){i=require("crypto"),e=i.randomBytes(128),t.random.addEntropy(e,1024,"crypto.randomBytes")}else{if(window&&Uint32Array){if(r=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues){window.crypto.getRandomValues(r)}else{if(!window.msCrypto||!window.msCrypto.getRandomValues){return}window.msCrypto.getRandomValues(r)}t.random.addEntropy(r,1024,"crypto.getRandomValues")}}}catch(o){console.log("There was an error collecting entropy from the browser:"),console.log(o)}}(),t.mode.ccm={name:"ccm",encrypt:function(e,i,n,r,o){var s,c,h=i.slice(0),f=t.bitArray,u=f.bitLength(n)/8,l=f.bitLength(h)/8;if(o=o||64,r=r||[],7>u){throw new t.exception.invalid("ccm: iv must be at least 7 bytes")}for(s=2;4>s&&l>>>8*s;s++){}return 15-u>s&&(s=15-u),n=f.clamp(n,8*(15-s)),c=t.mode.ccm._computeTag(e,i,n,r,o,s),h=t.mode.ccm._ctrMode(e,h,n,c,o,s),f.concat(h.data,h.tag)},decrypt:function(e,i,n,r,o){o=o||64,r=r||[];var s,p,h=t.bitArray,c=h.bitLength(n)/8,f=h.bitLength(i),u=h.clamp(i,f-o),l=h.bitSlice(i,f-o);if(f=(f-o)/8,7>c){throw new t.exception.invalid("ccm: iv must be at least 7 bytes")}for(s=2;4>s&&f>>>8*s;s++){}if(15-c>s&&(s=15-c),n=h.clamp(n,8*(15-s)),u=t.mode.ccm._ctrMode(e,u,n,l,o,s),p=t.mode.ccm._computeTag(e,u.data,n,r,o,s),!h.equal(u.tag,p)){throw new t.exception.corrupt("ccm: tag doesn't match")}return u.data},_computeTag:function(e,i,n,r,o,s){var h,u,l,p=[],d=t.bitArray,g=d._xor4;if(o/=8,o%2||4>o||o>16){throw new t.exception.invalid("ccm: invalid tag length")}if(r.length>4294967295||i.length>4294967295){throw new t.exception.bug("ccm: can't deal with 4GiB or more data")}if(h=[d.partial(8,(r.length?64:0)|o-2<<2|s-1)],h=d.concat(h,n),h[3]|=d.bitLength(i)/8,h=e.encrypt(h),r.length){for(u=d.bitLength(r)/8,65279>=u?p=[d.partial(16,u)]:4294967295>=u&&(p=d.concat([d.partial(16,65534)],[u])),p=d.concat(p,r),l=0;l<p.length;l+=4){h=e.encrypt(g(h,p.slice(l,l+4).concat([0,0,0])))}}for(l=0;l<i.length;l+=4){h=e.encrypt(g(h,i.slice(l,l+4).concat([0,0,0])))}return d.clamp(h,8*o)},_ctrMode:function(e,i,n,r,o,s){var a,h,u,c=t.bitArray,f=c._xor4,p=i.length,d=c.bitLength(i);if(u=c.concat([c.partial(8,s-1)],n).concat([0,0,0]).slice(0,4),r=c.bitSlice(f(r,e.encrypt(u)),0,o),!p){return{tag:r,data:[]}}for(h=0;p>h;h+=4){u[3]++,a=e.encrypt(u),i[h]^=a[0],i[h+1]^=a[1],i[h+2]^=a[2],i[h+3]^=a[3]}return{tag:r,data:c.clamp(i,d)}}};var e=function(e){var i;return i=function(i,n,r){var o,s,a,h,c,f,u,l;if(i instanceof String||"string"==typeof i){c=t.codec.utf8String.toBits(i)}else{if(i instanceof ArrayBuffer){l=new Uint8Array(i),c=t.codec.bytes.toBits(l)}else{if(!(i instanceof Buffer)){throw Error("invalid input type")}c=t.codec.bytes.toBits(i)}}return r.cipher="aes",r.mode=e,null!=r.iv?a=t.codec.hex.toBits(r.iv):(a=t.random.randomWords(4,0),r.iv=t.codec.hex.fromBits(a)),null!=r.salt?u=t.codec.hex.toBits(r.salt):(u=t.random.randomWords(2,0),r.salt=t.codec.hex.fromBits(u)),h=t.misc.pbkdf2(n,u,r.iter).slice(0,r.ks/32),o=t.codec.utf8String.toBits(r.auth),f=new t.cipher.aes(h),s=t.mode[e].encrypt(f,c,a,o,r.ts),new Buffer(t.codec.bytes.fromBits(s))},function(t,n,r){var o,s,a,h;return h={iter:r.coding_func.iter,ks:r.coding_func.ks,ts:r.coding_func.ts,auth:n.url},a="aes-"+e+"-"+h.ks+"-"+h.ts+"-"+h.iter+"-"+n.source_hash+"-"+h.auth,r.cache.has(a)&&(o=r.cache.get(a),h.salt=o.salt,h.iv=o.iv),s=i(t,r.coding_func.password,h),n.decoding=h,r.cache.set(a,h),s}};return e("ccm")})();