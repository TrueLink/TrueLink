(function(){"use strict";var t={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};"undefined"!=typeof module&&module.exports&&(module.exports=t),t.bitArray={bitSlice:function(n,r,i){return n=t.bitArray._shiftRight(n.slice(r/32),32-(31&r)).slice(1),void 0===i?n:t.bitArray.clamp(n,i-r)},extract:function(t,n,r){var i,e=Math.floor(-n-r&31);return i=-32&(n+r-1^n)?t[n/32|0]<<32-e^t[n/32+1|0]>>>e:t[n/32|0]>>>e,i&(1<<r)-1},concat:function(n,r){if(0===n.length||0===r.length){return n.concat(r)}var s=n[n.length-1],o=t.bitArray.getPartial(s);return 32===o?n.concat(r):t.bitArray._shiftRight(r,o,0|s,n.slice(0,n.length-1))},bitLength:function(n){var i,r=n.length;return 0===r?0:(i=n[r-1],32*(r-1)+t.bitArray.getPartial(i))},clamp:function(n,r){if(32*n.length<r){return n}n=n.slice(0,Math.ceil(r/32));var i=n.length;return r=31&r,i>0&&r&&(n[i-1]=t.bitArray.partial(r,n[i-1]&2147483648>>r-1,1)),n},partial:function(t,n,r){return 32===t?n:(r?0|n:n<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(n,r){if(t.bitArray.bitLength(n)!==t.bitArray.bitLength(r)){return!1}var e,i=0;for(e=0;e<n.length;e++){i|=n[e]^r[e]}return 0===i},_shiftRight:function(n,r,i,e){var s,a,o=0;for(void 0===e&&(e=[]);r>=32;r-=32){e.push(i),i=0}if(0===r){return e.concat(n)}for(s=0;s<n.length;s++){e.push(i|n[s]>>>r),i=n[s]<<32-r}return o=n.length?n[n.length-1]:0,a=t.bitArray.getPartial(o),e.push(t.bitArray.partial(r+a&31,r+a>32?i:e.pop(),1)),e},_xor4:function(t,n){return[t[0]^n[0],t[1]^n[1],t[2]^n[2],t[3]^n[3]]}},t.codec.bytes={fromBits:function(n){var e,s,r=[],i=t.bitArray.bitLength(n);for(e=0;i/8>e;e++){0===(3&e)&&(s=n[e/4]),r.push(s>>>24),s<<=8}return r},toBits:function(n){var i,r=[],e=0;for(i=0;i<n.length;i++){e=e<<8|n[i],3===(3&i)&&(r.push(e),e=0)}return 3&i&&r.push(t.bitArray.partial(8*(3&i),e)),r}},t.codec.utf8String={fromBits:function(n){var e,s,r="",i=t.bitArray.bitLength(n);for(e=0;i/8>e;e++){0===(3&e)&&(s=n[e/4]),r+=String.fromCharCode(s>>>24),s<<=8}return decodeURIComponent(escape(r))},toBits:function(n){n=unescape(encodeURIComponent(n));var i,r=[],e=0;for(i=0;i<n.length;i++){e=e<<8|n.charCodeAt(i),3===(3&i)&&(r.push(e),e=0)}return 3&i&&r.push(t.bitArray.partial(8*(3&i),e)),r}};var n=function(){return function(n){var r,i;if(n instanceof String||"string"==typeof n){r=n}else{if(n instanceof ArrayBuffer){i=new Uint8Array(n),r=t.codec.utf8String.fromBits(t.codec.bytes.toBits(i))}else{if(!(n instanceof Buffer)){throw Error("invalid input type")}r=t.codec.utf8String.fromBits(t.codec.bytes.toBits(n))}}return r}};return n()})();